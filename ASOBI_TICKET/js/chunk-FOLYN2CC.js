import{a as cr,c as ur,e as pe,g as ot,i as fr,j as lr,l as dr}from"./chunk-AWGLQW6G.js";import{h as $e}from"./chunk-KLXVAUUB.js";import{B as Ue,w as Me}from"./chunk-KZ3A2NRO.js";import{d as hr}from"./chunk-UZVF6O5E.js";import{a as ar}from"./chunk-DBRRJBUZ.js";import{a as nr,d as or,e as ir,f as sr,i as be}from"./chunk-264EOGRT.js";import{$a as K,Aa as te,Bc as Fe,C as Nt,D as Ot,Eb as J,F as De,H as rt,Hb as Gt,Ib as Qt,J as Bt,Pb as Oe,Qa as de,Qc as Le,R as Ft,S as nt,Sa as ie,Tc as er,Uc as tr,W as $,Wa as he,X as Lt,Y as ke,Ya as Kt,Za as Yt,_,_a as j,_c as rr,a as At,ab as ae,ac as Xt,ba as q,c as xe,ca as Mt,e as Dn,ea as Ut,eb as Wt,fc as qt,g as kn,gb as Ne,h as w,ib as se,ic as Z,ka as $t,kc as Jt,la as jt,m as Rt,ma as zt,na as Pe,qc as Be,r as Dt,s as kt,sb as Ht,t as V,tb as ce,u as Pt,ua as Vt,ub as Ie,v as ye,yc as Zt}from"./chunk-I424EGRW.js";var vr=Dn((mr,it)=>{"use strict";(function(u){if(typeof mr=="object"&&typeof it<"u")it.exports=u();else if(typeof define=="function"&&define.amd)define([],u);else{var i;typeof window<"u"?i=window:typeof global<"u"?i=global:typeof self<"u"?i=self:i=this,i.localforage=u()}})(function(){var u,i,E;return function c(l,y,S){function R(N,W){if(!y[N]){if(!l[N]){var v=typeof xe=="function"&&xe;if(!W&&v)return v(N,!0);if(C)return C(N,!0);var b=new Error("Cannot find module '"+N+"'");throw b.code="MODULE_NOT_FOUND",b}var O=y[N]={exports:{}};l[N][0].call(O.exports,function(B){var ee=l[N][1][B];return R(ee||B)},O,O.exports,c,l,y,S)}return y[N].exports}for(var C=typeof xe=="function"&&xe,P=0;P<S.length;P++)R(S[P]);return R}({1:[function(c,l,y){(function(S){"use strict";var R=S.MutationObserver||S.WebKitMutationObserver,C;if(R){var P=0,N=new R(B),W=S.document.createTextNode("");N.observe(W,{characterData:!0}),C=function(){W.data=P=++P%2}}else if(!S.setImmediate&&typeof S.MessageChannel<"u"){var v=new S.MessageChannel;v.port1.onmessage=B,C=function(){v.port2.postMessage(0)}}else"document"in S&&"onreadystatechange"in S.document.createElement("script")?C=function(){var M=S.document.createElement("script");M.onreadystatechange=function(){B(),M.onreadystatechange=null,M.parentNode.removeChild(M),M=null},S.document.documentElement.appendChild(M)}:C=function(){setTimeout(B,0)};var b,O=[];function B(){b=!0;for(var M,re,U=O.length;U;){for(re=O,O=[],M=-1;++M<U;)re[M]();U=O.length}b=!1}l.exports=ee;function ee(M){O.push(M)===1&&!b&&C()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(c,l,y){"use strict";var S=c(1);function R(){}var C={},P=["REJECTED"],N=["FULFILLED"],W=["PENDING"];l.exports=v;function v(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=W,this.queue=[],this.outcome=void 0,m!==R&&ee(this,m)}v.prototype.catch=function(m){return this.then(null,m)},v.prototype.then=function(m,T){if(typeof m!="function"&&this.state===N||typeof T!="function"&&this.state===P)return this;var I=new this.constructor(R);if(this.state!==W){var k=this.state===N?m:T;O(I,k,this.outcome)}else this.queue.push(new b(I,m,T));return I};function b(m,T,I){this.promise=m,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof I=="function"&&(this.onRejected=I,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(m){C.resolve(this.promise,m)},b.prototype.otherCallFulfilled=function(m){O(this.promise,this.onFulfilled,m)},b.prototype.callRejected=function(m){C.reject(this.promise,m)},b.prototype.otherCallRejected=function(m){O(this.promise,this.onRejected,m)};function O(m,T,I){S(function(){var k;try{k=T(I)}catch(z){return C.reject(m,z)}k===m?C.reject(m,new TypeError("Cannot resolve promise with itself")):C.resolve(m,k)})}C.resolve=function(m,T){var I=M(B,T);if(I.status==="error")return C.reject(m,I.value);var k=I.value;if(k)ee(m,k);else{m.state=N,m.outcome=T;for(var z=-1,H=m.queue.length;++z<H;)m.queue[z].callFulfilled(T)}return m},C.reject=function(m,T){m.state=P,m.outcome=T;for(var I=-1,k=m.queue.length;++I<k;)m.queue[I].callRejected(T);return m};function B(m){var T=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof T=="function")return function(){T.apply(m,arguments)}}function ee(m,T){var I=!1;function k(Q){I||(I=!0,C.reject(m,Q))}function z(Q){I||(I=!0,C.resolve(m,Q))}function H(){T(z,k)}var G=M(H);G.status==="error"&&k(G.value)}function M(m,T){var I={};try{I.value=m(T),I.status="success"}catch(k){I.status="error",I.value=k}return I}v.resolve=re;function re(m){return m instanceof this?m:C.resolve(new this(R),m)}v.reject=U;function U(m){var T=new this(R);return C.reject(T,m)}v.all=Ye;function Ye(m){var T=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=m.length,k=!1;if(!I)return this.resolve([]);for(var z=new Array(I),H=0,G=-1,Q=new this(R);++G<I;)ne(m[G],G);return Q;function ne(Se,Te){T.resolve(Se).then(We,function(ve){k||(k=!0,C.reject(Q,ve))});function We(ve){z[Te]=ve,++H===I&&!k&&(k=!0,C.resolve(Q,z))}}}v.race=me;function me(m){var T=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=m.length,k=!1;if(!I)return this.resolve([]);for(var z=-1,H=new this(R);++z<I;)G(m[z]);return H;function G(Q){T.resolve(Q).then(function(ne){k||(k=!0,C.resolve(H,ne))},function(ne){k||(k=!0,C.reject(H,ne))})}}},{1:1}],3:[function(c,l,y){(function(S){"use strict";typeof S.Promise!="function"&&(S.Promise=c(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(c,l,y){"use strict";var S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function R(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function C(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var P=C();function N(){try{if(!P||!P.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),r=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||r)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function W(e,r){e=e||[],r=r||{};try{return new Blob(e,r)}catch(n){if(n.name!=="TypeError")throw n;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,o=new t,a=0;a<e.length;a+=1)o.append(e[a]);return o.getBlob(r.type)}}typeof Promise>"u"&&c(3);var v=Promise;function b(e,r){r&&e.then(function(t){r(null,t)},function(t){r(t)})}function O(e,r,t){typeof r=="function"&&e.then(r),typeof t=="function"&&e.catch(t)}function B(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function ee(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var M="local-forage-detect-blob-support",re=void 0,U={},Ye=Object.prototype.toString,me="readonly",m="readwrite";function T(e){for(var r=e.length,t=new ArrayBuffer(r),o=new Uint8Array(t),a=0;a<r;a++)o[a]=e.charCodeAt(a);return t}function I(e){return new v(function(r){var t=e.transaction(M,m),o=W([""]);t.objectStore(M).put(o,"key"),t.onabort=function(a){a.preventDefault(),a.stopPropagation(),r(!1)},t.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);r(n||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function k(e){return typeof re=="boolean"?v.resolve(re):I(e).then(function(r){return re=r,re})}function z(e){var r=U[e.name],t={};t.promise=new v(function(o,a){t.resolve=o,t.reject=a}),r.deferredOperations.push(t),r.dbReady?r.dbReady=r.dbReady.then(function(){return t.promise}):r.dbReady=t.promise}function H(e){var r=U[e.name],t=r.deferredOperations.pop();if(t)return t.resolve(),t.promise}function G(e,r){var t=U[e.name],o=t.deferredOperations.pop();if(o)return o.reject(r),o.promise}function Q(e,r){return new v(function(t,o){if(U[e.name]=U[e.name]||ct(),e.db)if(r)z(e),e.db.close();else return t(e.db);var a=[e.name];r&&a.push(e.version);var n=P.open.apply(P,a);r&&(n.onupgradeneeded=function(s){var f=n.result;try{f.createObjectStore(e.storeName),s.oldVersion<=1&&f.createObjectStore(M)}catch(d){if(d.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+s.oldVersion+" to version "+s.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw d}}),n.onerror=function(s){s.preventDefault(),o(n.error)},n.onsuccess=function(){var s=n.result;s.onversionchange=function(f){f.target.close()},t(s),H(e)}})}function ne(e){return Q(e,!1)}function Se(e){return Q(e,!0)}function Te(e,r){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,a=e.version>e.db.version;if(o&&(e.version!==r&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||t){if(t){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function We(e){return new v(function(r,t){var o=new FileReader;o.onerror=t,o.onloadend=function(a){var n=btoa(a.target.result||"");r({__local_forage_encoded_blob:!0,data:n,type:e.type})},o.readAsBinaryString(e)})}function ve(e){var r=T(atob(e.data));return W([r],{type:e.type})}function st(e){return e&&e.__local_forage_encoded_blob}function Dr(e){var r=this,t=r._initReady().then(function(){var o=U[r._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return O(t,e,e),t}function kr(e){z(e);for(var r=U[e.name],t=r.forages,o=0;o<t.length;o++){var a=t[o];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,ne(e).then(function(n){return e.db=n,Te(e)?Se(e):n}).then(function(n){e.db=r.db=n;for(var s=0;s<t.length;s++)t[s]._dbInfo.db=n}).catch(function(n){throw G(e,n),n})}function oe(e,r,t,o){o===void 0&&(o=1);try{var a=e.db.transaction(e.storeName,r);t(null,a)}catch(n){if(o>0&&(!e.db||n.name==="InvalidStateError"||n.name==="NotFoundError"))return v.resolve().then(function(){if(!e.db||n.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),Se(e)}).then(function(){return kr(e).then(function(){oe(e,r,t,o-1)})}).catch(t);t(n)}}function ct(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Pr(e){var r=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var a=U[t.name];a||(a=ct(),U[t.name]=a),a.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=Dr);var n=[];function s(){return v.resolve()}for(var f=0;f<a.forages.length;f++){var d=a.forages[f];d!==r&&n.push(d._initReady().catch(s))}var h=a.forages.slice(0);return v.all(n).then(function(){return t.db=a.db,ne(t)}).then(function(p){return t.db=p,Te(t,r._defaultConfig.version)?Se(t):p}).then(function(p){t.db=a.db=p,r._dbInfo=t;for(var g=0;g<h.length;g++){var x=h[g];x!==r&&(x._dbInfo.db=t.db,x._dbInfo.version=t.version)}})}function Nr(e,r){var t=this;e=B(e);var o=new v(function(a,n){t.ready().then(function(){oe(t._dbInfo,me,function(s,f){if(s)return n(s);try{var d=f.objectStore(t._dbInfo.storeName),h=d.get(e);h.onsuccess=function(){var p=h.result;p===void 0&&(p=null),st(p)&&(p=ve(p)),a(p)},h.onerror=function(){n(h.error)}}catch(p){n(p)}})}).catch(n)});return b(o,r),o}function Or(e,r){var t=this,o=new v(function(a,n){t.ready().then(function(){oe(t._dbInfo,me,function(s,f){if(s)return n(s);try{var d=f.objectStore(t._dbInfo.storeName),h=d.openCursor(),p=1;h.onsuccess=function(){var g=h.result;if(g){var x=g.value;st(x)&&(x=ve(x));var A=e(x,g.key,p++);A!==void 0?a(A):g.continue()}else a()},h.onerror=function(){n(h.error)}}catch(g){n(g)}})}).catch(n)});return b(o,r),o}function Br(e,r,t){var o=this;e=B(e);var a=new v(function(n,s){var f;o.ready().then(function(){return f=o._dbInfo,Ye.call(r)==="[object Blob]"?k(f.db).then(function(d){return d?r:We(r)}):r}).then(function(d){oe(o._dbInfo,m,function(h,p){if(h)return s(h);try{var g=p.objectStore(o._dbInfo.storeName);d===null&&(d=void 0);var x=g.put(d,e);p.oncomplete=function(){d===void 0&&(d=null),n(d)},p.onabort=p.onerror=function(){var A=x.error?x.error:x.transaction.error;s(A)}}catch(A){s(A)}})}).catch(s)});return b(a,t),a}function Fr(e,r){var t=this;e=B(e);var o=new v(function(a,n){t.ready().then(function(){oe(t._dbInfo,m,function(s,f){if(s)return n(s);try{var d=f.objectStore(t._dbInfo.storeName),h=d.delete(e);f.oncomplete=function(){a()},f.onerror=function(){n(h.error)},f.onabort=function(){var p=h.error?h.error:h.transaction.error;n(p)}}catch(p){n(p)}})}).catch(n)});return b(o,r),o}function Lr(e){var r=this,t=new v(function(o,a){r.ready().then(function(){oe(r._dbInfo,m,function(n,s){if(n)return a(n);try{var f=s.objectStore(r._dbInfo.storeName),d=f.clear();s.oncomplete=function(){o()},s.onabort=s.onerror=function(){var h=d.error?d.error:d.transaction.error;a(h)}}catch(h){a(h)}})}).catch(a)});return b(t,e),t}function Mr(e){var r=this,t=new v(function(o,a){r.ready().then(function(){oe(r._dbInfo,me,function(n,s){if(n)return a(n);try{var f=s.objectStore(r._dbInfo.storeName),d=f.count();d.onsuccess=function(){o(d.result)},d.onerror=function(){a(d.error)}}catch(h){a(h)}})}).catch(a)});return b(t,e),t}function Ur(e,r){var t=this,o=new v(function(a,n){if(e<0){a(null);return}t.ready().then(function(){oe(t._dbInfo,me,function(s,f){if(s)return n(s);try{var d=f.objectStore(t._dbInfo.storeName),h=!1,p=d.openKeyCursor();p.onsuccess=function(){var g=p.result;if(!g){a(null);return}e===0||h?a(g.key):(h=!0,g.advance(e))},p.onerror=function(){n(p.error)}}catch(g){n(g)}})}).catch(n)});return b(o,r),o}function $r(e){var r=this,t=new v(function(o,a){r.ready().then(function(){oe(r._dbInfo,me,function(n,s){if(n)return a(n);try{var f=s.objectStore(r._dbInfo.storeName),d=f.openKeyCursor(),h=[];d.onsuccess=function(){var p=d.result;if(!p){o(h);return}h.push(p.key),p.continue()},d.onerror=function(){a(d.error)}}catch(p){a(p)}})}).catch(a)});return b(t,e),t}function jr(e,r){r=ee.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;if(!e.name)a=v.reject("Invalid arguments");else{var n=e.name===t.name&&o._dbInfo.db,s=n?v.resolve(o._dbInfo.db):ne(e).then(function(f){var d=U[e.name],h=d.forages;d.db=f;for(var p=0;p<h.length;p++)h[p]._dbInfo.db=f;return f});e.storeName?a=s.then(function(f){if(f.objectStoreNames.contains(e.storeName)){var d=f.version+1;z(e);var h=U[e.name],p=h.forages;f.close();for(var g=0;g<p.length;g++){var x=p[g];x._dbInfo.db=null,x._dbInfo.version=d}var A=new v(function(D,L){var F=P.open(e.name,d);F.onerror=function(X){var Ce=F.result;Ce.close(),L(X)},F.onupgradeneeded=function(){var X=F.result;X.deleteObjectStore(e.storeName)},F.onsuccess=function(){var X=F.result;X.close(),D(X)}});return A.then(function(D){h.db=D;for(var L=0;L<p.length;L++){var F=p[L];F._dbInfo.db=D,H(F._dbInfo)}}).catch(function(D){throw(G(e,D)||v.resolve()).catch(function(){}),D})}}):a=s.then(function(f){z(e);var d=U[e.name],h=d.forages;f.close();for(var p=0;p<h.length;p++){var g=h[p];g._dbInfo.db=null}var x=new v(function(A,D){var L=P.deleteDatabase(e.name);L.onerror=function(){var F=L.result;F&&F.close(),D(L.error)},L.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},L.onsuccess=function(){var F=L.result;F&&F.close(),A(F)}});return x.then(function(A){d.db=A;for(var D=0;D<h.length;D++){var L=h[D];H(L._dbInfo)}}).catch(function(A){throw(G(e,A)||v.resolve()).catch(function(){}),A})})}return b(a,r),a}var zr={_driver:"asyncStorage",_initStorage:Pr,_support:N(),iterate:Or,getItem:Nr,setItem:Br,removeItem:Fr,clear:Lr,length:Mr,key:Ur,keys:$r,dropInstance:jr};function Vr(){return typeof openDatabase=="function"}var fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kr="~~local_forage_type~",ut=/^~~local_forage_type~([^~]+)~/,Ae="__lfsc__:",He=Ae.length,Ge="arbf",Qe="blob",ft="si08",lt="ui08",dt="uic8",ht="si16",pt="si32",mt="ur16",vt="ui32",gt="fl32",yt="fl64",bt=He+Ge.length,_t=Object.prototype.toString;function St(e){var r=e.length*.75,t=e.length,o,a=0,n,s,f,d;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);var h=new ArrayBuffer(r),p=new Uint8Array(h);for(o=0;o<t;o+=4)n=fe.indexOf(e[o]),s=fe.indexOf(e[o+1]),f=fe.indexOf(e[o+2]),d=fe.indexOf(e[o+3]),p[a++]=n<<2|s>>4,p[a++]=(s&15)<<4|f>>2,p[a++]=(f&3)<<6|d&63;return h}function Xe(e){var r=new Uint8Array(e),t="",o;for(o=0;o<r.length;o+=3)t+=fe[r[o]>>2],t+=fe[(r[o]&3)<<4|r[o+1]>>4],t+=fe[(r[o+1]&15)<<2|r[o+2]>>6],t+=fe[r[o+2]&63];return r.length%3===2?t=t.substring(0,t.length-1)+"=":r.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function Yr(e,r){var t="";if(e&&(t=_t.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&_t.call(e.buffer)==="[object ArrayBuffer]")){var o,a=Ae;e instanceof ArrayBuffer?(o=e,a+=Ge):(o=e.buffer,t==="[object Int8Array]"?a+=ft:t==="[object Uint8Array]"?a+=lt:t==="[object Uint8ClampedArray]"?a+=dt:t==="[object Int16Array]"?a+=ht:t==="[object Uint16Array]"?a+=mt:t==="[object Int32Array]"?a+=pt:t==="[object Uint32Array]"?a+=vt:t==="[object Float32Array]"?a+=gt:t==="[object Float64Array]"?a+=yt:r(new Error("Failed to get type for BinaryArray"))),r(a+Xe(o))}else if(t==="[object Blob]"){var n=new FileReader;n.onload=function(){var s=Kr+e.type+"~"+Xe(this.result);r(Ae+Qe+s)},n.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),r(null,s)}}function Wr(e){if(e.substring(0,He)!==Ae)return JSON.parse(e);var r=e.substring(bt),t=e.substring(He,bt),o;if(t===Qe&&ut.test(r)){var a=r.match(ut);o=a[1],r=r.substring(a[0].length)}var n=St(r);switch(t){case Ge:return n;case Qe:return W([n],{type:o});case ft:return new Int8Array(n);case lt:return new Uint8Array(n);case dt:return new Uint8ClampedArray(n);case ht:return new Int16Array(n);case mt:return new Uint16Array(n);case pt:return new Int32Array(n);case vt:return new Uint32Array(n);case gt:return new Float32Array(n);case yt:return new Float64Array(n);default:throw new Error("Unkown type: "+t)}}var qe={serialize:Yr,deserialize:Wr,stringToBuffer:St,bufferToString:Xe};function wt(e,r,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function Hr(e){var r=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var a=new v(function(n,s){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(f){return s(f)}t.db.transaction(function(f){wt(f,t,function(){r._dbInfo=t,n()},function(d,h){s(h)})},s)});return t.serializer=qe,a}function le(e,r,t,o,a,n){e.executeSql(t,o,a,function(s,f){f.code===f.SYNTAX_ERR?s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(d,h){h.rows.length?n(d,f):wt(d,r,function(){d.executeSql(t,o,a,n)},n)},n):n(s,f)},n)}function Gr(e,r){var t=this;e=B(e);var o=new v(function(a,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(f){le(f,s,"SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],function(d,h){var p=h.rows.length?h.rows.item(0).value:null;p&&(p=s.serializer.deserialize(p)),a(p)},function(d,h){n(h)})})}).catch(n)});return b(o,r),o}function Qr(e,r){var t=this,o=new v(function(a,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(f){le(f,s,"SELECT * FROM "+s.storeName,[],function(d,h){for(var p=h.rows,g=p.length,x=0;x<g;x++){var A=p.item(x),D=A.value;if(D&&(D=s.serializer.deserialize(D)),D=e(D,A.key,x+1),D!==void 0){a(D);return}}a()},function(d,h){n(h)})})}).catch(n)});return b(o,r),o}function Ct(e,r,t,o){var a=this;e=B(e);var n=new v(function(s,f){a.ready().then(function(){r===void 0&&(r=null);var d=r,h=a._dbInfo;h.serializer.serialize(r,function(p,g){g?f(g):h.db.transaction(function(x){le(x,h,"INSERT OR REPLACE INTO "+h.storeName+" (key, value) VALUES (?, ?)",[e,p],function(){s(d)},function(A,D){f(D)})},function(x){if(x.code===x.QUOTA_ERR){if(o>0){s(Ct.apply(a,[e,d,t,o-1]));return}f(x)}})})}).catch(f)});return b(n,t),n}function Xr(e,r,t){return Ct.apply(this,[e,r,t,1])}function qr(e,r){var t=this;e=B(e);var o=new v(function(a,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(f){le(f,s,"DELETE FROM "+s.storeName+" WHERE key = ?",[e],function(){a()},function(d,h){n(h)})})}).catch(n)});return b(o,r),o}function Jr(e){var r=this,t=new v(function(o,a){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){le(s,n,"DELETE FROM "+n.storeName,[],function(){o()},function(f,d){a(d)})})}).catch(a)});return b(t,e),t}function Zr(e){var r=this,t=new v(function(o,a){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){le(s,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(f,d){var h=d.rows.item(0).c;o(h)},function(f,d){a(d)})})}).catch(a)});return b(t,e),t}function en(e,r){var t=this,o=new v(function(a,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(f){le(f,s,"SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],function(d,h){var p=h.rows.length?h.rows.item(0).key:null;a(p)},function(d,h){n(h)})})}).catch(n)});return b(o,r),o}function tn(e){var r=this,t=new v(function(o,a){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){le(s,n,"SELECT key FROM "+n.storeName,[],function(f,d){for(var h=[],p=0;p<d.rows.length;p++)h.push(d.rows.item(p).key);o(h)},function(f,d){a(d)})})}).catch(a)});return b(t,e),t}function rn(e){return new v(function(r,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(a,n){for(var s=[],f=0;f<n.rows.length;f++)s.push(n.rows.item(f).name);r({db:e,storeNames:s})},function(a,n){t(n)})},function(o){t(o)})})}function nn(e,r){r=ee.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;return e.name?a=new v(function(n){var s;e.name===t.name?s=o._dbInfo.db:s=openDatabase(e.name,"","",0),e.storeName?n({db:s,storeNames:[e.storeName]}):n(rn(s))}).then(function(n){return new v(function(s,f){n.db.transaction(function(d){function h(A){return new v(function(D,L){d.executeSql("DROP TABLE IF EXISTS "+A,[],function(){D()},function(F,X){L(X)})})}for(var p=[],g=0,x=n.storeNames.length;g<x;g++)p.push(h(n.storeNames[g]));v.all(p).then(function(){s()}).catch(function(A){f(A)})},function(d){f(d)})})}):a=v.reject("Invalid arguments"),b(a,r),a}var on={_driver:"webSQLStorage",_initStorage:Hr,_support:Vr(),iterate:Qr,getItem:Gr,setItem:Xr,removeItem:qr,clear:Jr,length:Zr,key:en,keys:tn,dropInstance:nn};function an(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function xt(e,r){var t=e.name+"/";return e.storeName!==r.storeName&&(t+=e.storeName+"/"),t}function sn(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}function cn(){return!sn()||localStorage.length>0}function un(e){var r=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=xt(e,r._defaultConfig),cn()?(r._dbInfo=t,t.serializer=qe,v.resolve()):v.reject()}function fn(e){var r=this,t=r.ready().then(function(){for(var o=r._dbInfo.keyPrefix,a=localStorage.length-1;a>=0;a--){var n=localStorage.key(a);n.indexOf(o)===0&&localStorage.removeItem(n)}});return b(t,e),t}function ln(e,r){var t=this;e=B(e);var o=t.ready().then(function(){var a=t._dbInfo,n=localStorage.getItem(a.keyPrefix+e);return n&&(n=a.serializer.deserialize(n)),n});return b(o,r),o}function dn(e,r){var t=this,o=t.ready().then(function(){for(var a=t._dbInfo,n=a.keyPrefix,s=n.length,f=localStorage.length,d=1,h=0;h<f;h++){var p=localStorage.key(h);if(p.indexOf(n)===0){var g=localStorage.getItem(p);if(g&&(g=a.serializer.deserialize(g)),g=e(g,p.substring(s),d++),g!==void 0)return g}}});return b(o,r),o}function hn(e,r){var t=this,o=t.ready().then(function(){var a=t._dbInfo,n;try{n=localStorage.key(e)}catch{n=null}return n&&(n=n.substring(a.keyPrefix.length)),n});return b(o,r),o}function pn(e){var r=this,t=r.ready().then(function(){for(var o=r._dbInfo,a=localStorage.length,n=[],s=0;s<a;s++){var f=localStorage.key(s);f.indexOf(o.keyPrefix)===0&&n.push(f.substring(o.keyPrefix.length))}return n});return b(t,e),t}function mn(e){var r=this,t=r.keys().then(function(o){return o.length});return b(t,e),t}function vn(e,r){var t=this;e=B(e);var o=t.ready().then(function(){var a=t._dbInfo;localStorage.removeItem(a.keyPrefix+e)});return b(o,r),o}function gn(e,r,t){var o=this;e=B(e);var a=o.ready().then(function(){r===void 0&&(r=null);var n=r;return new v(function(s,f){var d=o._dbInfo;d.serializer.serialize(r,function(h,p){if(p)f(p);else try{localStorage.setItem(d.keyPrefix+e,h),s(n)}catch(g){(g.name==="QuotaExceededError"||g.name==="NS_ERROR_DOM_QUOTA_REACHED")&&f(g),f(g)}})})});return b(a,t),a}function yn(e,r){if(r=ee.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,a;return e.name?a=new v(function(n){e.storeName?n(xt(e,o._defaultConfig)):n(e.name+"/")}).then(function(n){for(var s=localStorage.length-1;s>=0;s--){var f=localStorage.key(s);f.indexOf(n)===0&&localStorage.removeItem(f)}}):a=v.reject("Invalid arguments"),b(a,r),a}var bn={_driver:"localStorageWrapper",_initStorage:un,_support:an(),iterate:dn,getItem:ln,setItem:gn,removeItem:vn,clear:fn,length:mn,key:hn,keys:pn,dropInstance:yn},_n=function(r,t){return r===t||typeof r=="number"&&typeof t=="number"&&isNaN(r)&&isNaN(t)},Sn=function(r,t){for(var o=r.length,a=0;a<o;){if(_n(r[a],t))return!0;a++}return!1},It=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},we={},Et={},ge={INDEXEDDB:zr,WEBSQL:on,LOCALSTORAGE:bn},wn=[ge.INDEXEDDB._driver,ge.WEBSQL._driver,ge.LOCALSTORAGE._driver],Re=["dropInstance"],Je=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Re),Cn={description:"",driver:wn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function xn(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}function Ze(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var t in r)r.hasOwnProperty(t)&&(It(r[t])?arguments[0][t]=r[t].slice():arguments[0][t]=r[t])}return arguments[0]}var In=function(){function e(r){R(this,e);for(var t in ge)if(ge.hasOwnProperty(t)){var o=ge[t],a=o._driver;this[t]=a,we[a]||this.defineDriver(o)}this._defaultConfig=Ze({},Cn),this._config=Ze({},this._defaultConfig,r),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":S(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,a){var n=new v(function(s,f){try{var d=t._driver,h=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){f(h);return}for(var p=Je.concat("_initStorage"),g=0,x=p.length;g<x;g++){var A=p[g],D=!Sn(Re,A);if((D||t[A])&&typeof t[A]!="function"){f(h);return}}var L=function(){for(var Ce=function(An){return function(){var Rn=new Error("Method "+An+" is not implemented by the current driver"),Tt=v.reject(Rn);return b(Tt,arguments[arguments.length-1]),Tt}},et=0,Tn=Re.length;et<Tn;et++){var tt=Re[et];t[tt]||(t[tt]=Ce(tt))}};L();var F=function(Ce){we[d]&&console.info("Redefining LocalForage driver: "+d),we[d]=t,Et[d]=Ce,s()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then(F,f):F(!!t._support):F(!0)}catch(X){f(X)}});return O(n,o,a),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,a){var n=we[t]?v.resolve(we[t]):v.reject(new Error("Driver not found."));return O(n,o,a),n},e.prototype.getSerializer=function(t){var o=v.resolve(qe);return O(o,t),o},e.prototype.ready=function(t){var o=this,a=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return O(a,t,t),a},e.prototype.setDriver=function(t,o,a){var n=this;It(t)||(t=[t]);var s=this._getSupportedDrivers(t);function f(){n._config.driver=n.driver()}function d(g){return n._extend(g),f(),n._ready=n._initStorage(n._config),n._ready}function h(g){return function(){var x=0;function A(){for(;x<g.length;){var D=g[x];return x++,n._dbInfo=null,n._ready=null,n.getDriver(D).then(d).catch(A)}f();var L=new Error("No available storage method found.");return n._driverSet=v.reject(L),n._driverSet}return A()}}var p=this._driverSet!==null?this._driverSet.catch(function(){return v.resolve()}):v.resolve();return this._driverSet=p.then(function(){var g=s[0];return n._dbInfo=null,n._ready=null,n.getDriver(g).then(function(x){n._driver=x._driver,f(),n._wrapLibraryMethodsWithReady(),n._initDriver=h(s)})}).catch(function(){f();var g=new Error("No available storage method found.");return n._driverSet=v.reject(g),n._driverSet}),O(this._driverSet,o,a),this._driverSet},e.prototype.supports=function(t){return!!Et[t]},e.prototype._extend=function(t){Ze(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],a=0,n=t.length;a<n;a++){var s=t[a];this.supports(s)&&o.push(s)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=Je.length;t<o;t++)xn(this,Je[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),En=new In;l.exports=En},{3:3}]},{},[4])(4)})});var pr=(()=>{let i=class i{constructor(){this.baseUrl="v1/private/me",this.http=_(Be)}fetchCurrentUser(){return this.http.get(this.baseUrl)}syncPersonalInfo(){return this.http.post(`${this.baseUrl}/personal_data/sync`,{})}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var Ee=kn(vr());var je={SecureStorage:"ionicSecureStorage",IndexedDB:Ee.default.INDEXEDDB,LocalStorage:Ee.default.LOCALSTORAGE},gr={name:"_ionicstorage",storeName:"_ionickv",dbKey:"_ionickey",driverOrder:[je.SecureStorage,je.IndexedDB,je.LocalStorage]},ue=class{constructor(i=gr){this._db=null,this._secureStorageDriver=null;let E=Object.assign({},gr,i||{});this._config=E}create(){return w(this,null,function*(){let i=Ee.default.createInstance(this._config);return this._db=i,yield i.setDriver(this._config.driverOrder||[]),this})}defineDriver(i){return w(this,null,function*(){return i._driver===je.SecureStorage&&(this._secureStorageDriver=i),Ee.default.defineDriver(i)})}get driver(){var i;return((i=this._db)===null||i===void 0?void 0:i.driver())||null}assertDb(){if(!this._db)throw new Error("Database not created. Must call create() first");return this._db}get(i){return this.assertDb().getItem(i)}set(i,E){return this.assertDb().setItem(i,E)}remove(i){return this.assertDb().removeItem(i)}clear(){return this.assertDb().clear()}length(){return this.assertDb().length()}keys(){return this.assertDb().keys()}forEach(i){return this.assertDb().iterate(i)}setEncryptionKey(i){var E;if(this._secureStorageDriver)(E=this._secureStorageDriver)===null||E===void 0||E.setEncryptionKey(i);else throw new Error("@ionic-enterprise/secure-storage not installed. Encryption support not available")}};var yr=new ke("STORAGE_CONFIG_TOKEN"),at=class extends ue{constructor(){super()}create(){return w(this,null,function*(){return this})}defineDriver(){return w(this,null,function*(){})}get driver(){return"noop"}get(i){return w(this,null,function*(){return null})}set(i,E){return w(this,null,function*(){})}remove(i){return w(this,null,function*(){})}clear(){return w(this,null,function*(){})}length(){return w(this,null,function*(){return 0})}keys(){return w(this,null,function*(){return[]})}forEach(i){return w(this,null,function*(){})}setEncryptionKey(i){}};function Pn(u,i){return Jt(u)?new at:new ue(i)}var Zn=(()=>{class u{static forRoot(E=null){return{ngModule:u,providers:[{provide:yr,useValue:E},{provide:ue,useFactory:Pn,deps:[Vt,yr]}]}}}return u.\u0275fac=function(E){return new(E||u)},u.\u0275mod=Mt({type:u}),u.\u0275inj=Lt({}),u})();var br=(()=>{let i=class i{};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac});let u=i;return u})();var _e=(()=>{let i=class i{get ready(){return V(this.ready$.pipe(De(c=>c)))}constructor(){this.storage=_(ue),this.storageRef=null,this.ready$=new Rt(!1),this.init()}init(){return w(this,null,function*(){this.storageRef=yield this.storage.create(),this.ready$.next(!0)})}get(c){return w(this,null,function*(){return yield this.ready,this.storageRef?.get(c)})}set(c,l){return w(this,null,function*(){return yield this.ready,this.storageRef?.set(c,l)})}remove(c){return w(this,null,function*(){return yield this.ready,this.storageRef?.remove(c)})}clear(){return w(this,null,function*(){return yield this.ready,this.storageRef?.clear()})}keys(){return w(this,null,function*(){return yield this.ready,this.storageRef?.keys()})}getStorage(){return w(this,null,function*(){return yield this.ready,this.storageRef})}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();function Nn(u,i){if(u&1&&(j(0,"div",6),ce(1),K()),u&2){let E=se();te(),Ie(E.email)}}var _r=(()=>{let i=class i{};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=q({type:i,selectors:[["tpl-user-info-overview"]],inputs:{name:"name",email:"email"},standalone:!0,features:[J],decls:9,vars:2,consts:[[1,"account"],["name","account-circle",1,"account-icon"],[1,"account-info"],[1,"account-info-name"],[1,"account-info-name-content"],[1,"account-info-name-title"],[1,"account-info-email"]],template:function(l,y){l&1&&(j(0,"div",0),ae(1,"tbx-icon",1),j(2,"div",2)(3,"div",3)(4,"div",4),ce(5),K(),j(6,"div",5),ce(7,"\u3055\u307E"),K()(),de(8,Nn,2,1,"div",6),K()()),l&2&&(te(5),Ie(y.name),te(3),he(y.email?8:-1))},dependencies:[Z,Le],styles:[".account[_ngcontent-%COMP%]{align-items:center;display:flex;min-width:0}.account-icon[_ngcontent-%COMP%]{height:46px;width:46px}.account-info[_ngcontent-%COMP%]{flex:1;margin-left:12px;min-width:0}.account-info-name[_ngcontent-%COMP%]{align-items:flex-end;display:flex;font-weight:600;line-height:1.4}.account-info-name-content[_ngcontent-%COMP%]{font-size:1.7rem;min-width:0}.account-info-name-title[_ngcontent-%COMP%]{flex-shrink:0;font-size:1.3rem;margin:0 .2em 0 .5em}.account-info-email[_ngcontent-%COMP%]{color:var(--tpl-color-text-light);font-size:1.5rem;line-height:1.3;margin-top:2px;word-break:break-all}"],changeDetection:0});let u=i;return u})();var ze=(()=>{let i=class i{constructor(){this.userApi=_(pr),this.store=_(be),this.storage=_(_e)}fetchCurrentUser(){return this.userApi.fetchCurrentUser().pipe(nt(c=>{this.store.dispatch(fr({user:c}))}),rt(c=>(c.status===401&&(this.storage.clear(),sessionStorage.clear(),this.store.dispatch(pe.signOut()),this.store.dispatch(pe.setApiAccessTokens({apiAccessToken:null}))),kt(()=>c))))}syncPersonalInfo(){let c=this.userApi.syncPersonalInfo().pipe(nt(l=>{this.store.dispatch(lr.syncPersonalInfo(l))}),ye(l=>or(l)),rt(l=>Dt(ir(new cr("\u66F4\u65B0\u306B\u5931\u6557\u3057\u307E\u3057\u305F",{originalErrorResponse:l})))));return V(c)}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var Sr=(()=>{let i=class i{constructor(){this.alertService=_(Ue),this.toastService=_($e),this.loaderService=_(Me),this.userService=_(ze),this.sessionService=_(br)}syncPersonalInfo(c=!0){return w(this,null,function*(){let l=this.loaderService.showLoader({message:"\u60C5\u5831\u3092\u66F4\u65B0\u3057\u3066\u3044\u307E\u3059..."}),y=yield this.userService.syncPersonalInfo();if(l.close(),y.isSuccess())c&&this.toastService.open({message:"\u66F4\u65B0\u304C\u5B8C\u4E86\u3057\u307E\u3057\u305F",duration:3e3});else{let S=yield this.alertService.showErrorAlertFromResponse(y.error.originalErrorResponse,"\u66F4\u65B0\u306B\u5931\u6557\u3057\u307E\u3057\u305F");yield V(S.closed),y.error.originalErrorResponse.status===401&&this.sessionService.signOut()}return y.isSuccess()})}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();function On(u,i){if(u&1&&(j(0,"div",3),zt(),j(1,"svg"),ae(2,"circle",5)(3,"circle",5),K()()),u&2){let E=se();te(3),Ht("--percent: ",E.progress,"; --color: var(--tpl-color-text-light);")}}var wr=(()=>{let i=class i{constructor(){this.disabled=!1,this.progress=0,this.cdRef=_(Oe),this.userUsecase=_(Sr),this.delayTime=6e4,this.delayTick=100}sync(){return w(this,null,function*(){(yield this.userUsecase.syncPersonalInfo())&&(this.disabled=!0,this.progress=0,this.cdRef.markForCheck(),Ot(this.delayTick).pipe(Ft(Nt(this.delayTime))).subscribe({next:()=>{this.progress+=this.delayTick/this.delayTime*100,this.cdRef.markForCheck()},complete:()=>{this.disabled=!1,this.progress=0,this.cdRef.markForCheck()}}))})}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=q({type:i,selectors:[["tpl-sync-personal-info"]],standalone:!0,features:[J],decls:7,vars:2,consts:[["tpl-button","","buttonType","plain","color","accent","width","auto","size","small","icon","sync","iconPosition","left",1,"button",3,"click","disabled"],[1,"container"],[1,"text"],[1,"progress"],[1,"desc"],["cx","8","cy","8","r","6"]],template:function(l,y){l&1&&(j(0,"button",0),Ne("click",function(){return y.sync()}),j(1,"div",1)(2,"div",2),ce(3,"\u66F4\u65B0\u60C5\u5831\u3092\u53CD\u6620\u3059\u308B"),K(),de(4,On,4,3,"div",3),K()(),j(5,"div",4),ce(6,"\u767B\u9332\u60C5\u5831\u306E\u53CD\u6620\u306B\u306F\u4E00\u5B9A\u6642\u9593\u304B\u304B\u308B\u3053\u3068\u304C\u3042\u308A\u307E\u3059"),K()),l&2&&(ie("disabled",y.disabled),te(4),he(y.disabled?4:-1))},dependencies:[Z,ar],styles:["[_nghost-%COMP%]{display:block;text-align:right}.container[_ngcontent-%COMP%]{align-items:center;display:flex;gap:8px;min-width:0}.button[_ngcontent-%COMP%]{--border-weight: 1px;--icon-font-size: 12px;font-size:1.2rem}.progress[_ngcontent-%COMP%]{height:16px;width:16px}.progress[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100%;position:relative;transform:rotate(-90deg);width:100%}.progress[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:none;height:100%;stroke:#f0f0f0;stroke-linecap:round;stroke-width:2;width:100%}.progress[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]:last-of-type{stroke:var(--color);stroke-dasharray:36px;stroke-dashoffset:calc(36px - 36px * var(--percent) / 100);transition:.1s}.desc[_ngcontent-%COMP%]{color:var(--tpl-color-text-light);font-size:1.1rem;margin-top:2px}"],changeDetection:0});let u=i;return u})();var Ko=(()=>{let i=class i{};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=q({type:i,selectors:[["tpl-user-info"]],inputs:{user:"user"},standalone:!0,features:[J],decls:3,vars:2,consts:[[3,"name","email"],[1,"sync"]],template:function(l,y){l&1&&(ae(0,"tpl-user-info-overview",0),j(1,"div",1),ae(2,"tpl-sync-personal-info"),K()),l&2&&ie("name",y.user.name)("email",y.user.email)},dependencies:[Z,wr,_r],styles:[".sync[_ngcontent-%COMP%]{margin-top:12px}"],changeDetection:0});let u=i;return u})();var Cr={common:{appName:"\u30C1\u30B1\u30C3\u30C8"},shared:{entry:{rankedChoiceLabel:"\u7B2C{{ rank }}\u5E0C\u671B",unrankedChoiceLabel:"\u9078\u629E{{ rank }}"}},components:{promoteMemberRankModal:{bottomRenderedNote:"\u767B\u9332\u6E08\u307F\u3067\u3001\u304A\u7533\u8FBC\u307F\u304C\u3067\u304D\u306A\u3044\u5834\u5408\u306F\u3001\u304A\u554F\u3044\u5408\u308F\u305B\u304F\u3060\u3055\u3044\u3002"},userNotice:{issuedTicketsExists:"\u304A\u77E5\u3089\u305B\u304C\u3042\u308A\u307E\u3059\u3002\u30C1\u30B1\u30C3\u30C8\u4E00\u89A7\u3092\u3054\u78BA\u8A8D\u304F\u3060\u3055\u3044\u3002",paymentRequiredEntryExists:"\u5165\u91D1\u304C\u5FC5\u8981\u306A\u7533\u8FBC\u304C\u3042\u308A\u307E\u3059",refundableEntryChoiceExists:"\u8FD4\u91D1\u30EA\u30AF\u30A8\u30B9\u30C8\u53EF\u80FD\u306A\u7533\u8FBC\u304C\u3042\u308A\u307E\u3059"}},pages:{boothList:{title:"\u30D6\u30FC\u30B9\u4E00\u89A7"}}};var Ve=new ke("TicketLocaleToken");function xr(){return Cr}var Ke=(()=>{let i=class i extends tr{constructor(){super(...arguments),this.locale=_(Ve)}};i.\u0275fac=(()=>{let c;return function(y){return(c||(c=Pe(i)))(y||i)}})(),i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var ii=(()=>{let i=class i extends er{constructor(){super(...arguments),this.localeService=_(Ke)}};i.\u0275fac=(()=>{let c;return function(y){return(c||(c=Pe(i)))(y||i)}})(),i.\u0275pipe=Ut({name:"ticketLocale",type:i,pure:!0,standalone:!0});let u=i;return u})();function ui(u){return[{provide:Ve,useFactory:()=>{let i=xr();return u?nr(i,u):i}}]}function Fn(u,i){if(u&1&&(j(0,"div",0),ae(1,"tbx-icon",1),j(2,"div",2),ce(3),K()()),u&2){let E=i;ie("ngClass",E.type),te(),ie("name",E.icon),te(2),Ie(E.message)}}var Ir=(()=>{let i=class i{constructor(){this.localeService=_(Ke),this.noticeData={payment_required_entry_exists:{icon:"alert-diamond",message:this.localeService.translate("components.userNotice.paymentRequiredEntryExists"),type:"attention"},issued_tickets_exists:{icon:"alert-diamond",message:this.localeService.translate("components.userNotice.issuedTicketsExists"),type:"attention"},refundable_entry_choice_exists:{icon:"alert-diamond",message:this.localeService.translate("components.userNotice.refundableEntryChoiceExists"),type:"attention"}}}get data(){return this.noticeData[this.notice.id]}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=q({type:i,selectors:[["tpl-user-notice"]],inputs:{notice:"notice"},standalone:!0,features:[J],decls:1,vars:1,consts:[[1,"notice",3,"ngClass"],[1,"notice-icon",3,"name"],[1,"notice-text"]],template:function(l,y){if(l&1&&de(0,Fn,4,3,"div",0),l&2){let S;he((S=y.data)?0:-1,S)}},dependencies:[Z,Xt,Le],styles:["[_nghost-%COMP%]{cursor:pointer;display:block;height:36px}.notice[_ngcontent-%COMP%]{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;padding:8px}.notice.attention[_ngcontent-%COMP%]{background-color:var(--tpl-color-attention);color:var(--tpl-color-attention-contrast)}.notice.primary[_ngcontent-%COMP%]{background-color:var(--tpl-color-primary);color:var(--tpl-color-primary-contrast)}.notice.accent[_ngcontent-%COMP%]{background-color:var(--tpl-color-accent);color:var(--tpl-color-accent-contrast)}.notice-icon[_ngcontent-%COMP%]{font-size:16px;margin-right:6px}.notice-text[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600}"],changeDetection:0});let u=i;return u})();var Ln=(u,i)=>i.id;function Mn(u,i){if(u&1){let E=Wt();j(0,"tpl-user-notice",1),Ne("click",function(){$t(E);let l=se().$implicit,y=se();return jt(y.tapNotice(l))}),K()}if(u&2){let E=se().$implicit;ie("notice",E)}}function Un(u,i){if(u&1&&de(0,Mn,1,1,"tpl-user-notice",0),u&2){let E=i.$implicit,c=se();he(c.shouldShowNotice(E)?0:-1)}}var Bi=(()=>{let i=class i{constructor(){this.navigateTable={payment_required_entry_exists:"/mypage/entries",issued_tickets_exists:"/mypage/tickets",refundable_entry_choice_exists:"/mypage/entries"},this.store=_(be),this.router=_(Fe),this.cdRef=_(Oe),this.userNotices$=this.store.select(dr).pipe(ye(c=>c?.notices??[])),this.currentUrl=this.router.url,this.router.events.pipe(De(c=>c instanceof Zt),sr()).subscribe(c=>{this.currentUrl=c.url,this.cdRef.markForCheck()})}tapNotice(c){let l=this.navigateTable[c.id];l&&this.router.navigate([l])}shouldShowNotice(c){return c.active&&!this.currentUrl.startsWith(this.navigateTable[c.id])}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=q({type:i,selectors:[["tpl-user-notice-control"]],standalone:!0,features:[J],decls:3,vars:2,consts:[[3,"notice"],[3,"click","notice"]],template:function(l,y){l&1&&(Kt(0,Un,1,1,null,null,Ln),Gt(2,"async")),l&2&&Yt(Qt(2,0,y.userNotices$))},dependencies:[Z,qt,Ir],changeDetection:0});let u=i;return u})();var Er=(()=>{let i=class i{constructor(){this.http=_(Be),this.appBaseUrl="v1/auth"}fetchProviderClientId(c){return this.http.get(`${this.appBaseUrl}/${c}/provider`)}createSession(c,l){return this.http.post(`${this.appBaseUrl}/${c}/session`,{idToken:l})}fetchToken(c,l,y,S,R="S256"){return this.http.post(`${c.endpointBase}/oauth/token`,{client_id:c.clientId,code:y,code_verifier:l,grant_type:"authorization_code",redirect_uri:S,code_challenge_method:R}).pipe(ye(C=>({accessToken:C.access_token,idToken:C.id_token,expiresIn:C.expires_in,tokenType:C.token_type,scope:C.scope})))}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var Tr=(()=>{let i=class i{constructor(){this.storageKeys={apiAccessToken:"api_access_token"},this.store=_(be),this.storage=_(_e)}getApiAccessTokenSnapshotFromStore(){return w(this,null,function*(){return V(this.store.select(ot).pipe(Bt(1)))})}getApiAccessTokenFromStore(){return w(this,null,function*(){return V(this.store.select(ot).pipe(rr(),Pt(6e4)))})}retrieveToken(){return w(this,null,function*(){let c=yield this.getApiAccessTokenFromStorage();return c?this.isTokenExpired(c.expiresAt)?(this.store.dispatch(pe.setApiAccessTokens({apiAccessToken:null})),this.clearAllTokens(),{accessToken:c.accessToken,isExpired:!0}):(this.store.dispatch(pe.setApiAccessTokens({apiAccessToken:c.accessToken})),{accessToken:c.accessToken,isExpired:!1}):(this.store.dispatch(pe.setApiAccessTokens({apiAccessToken:null})),null)})}getApiAccessTokenFromStorage(){return w(this,null,function*(){return this.storage.get(this.storageKeys.apiAccessToken)})}setApiAccessToken(c,l){return w(this,null,function*(){this.store.dispatch(pe.setApiAccessTokens({apiAccessToken:c})),yield this.storage.set(this.storageKeys.apiAccessToken,{accessToken:c,expiresAt:l})})}clearAllTokens(){return w(this,null,function*(){yield this.storage.remove(this.storageKeys.apiAccessToken)})}isTokenExpired(c){return ur(c,new Date)}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var Ar=(()=>{let i=class i{constructor(){this.codeVerifierKey="pkce_code_verifier",this.returnPathKey="auth_return_path",this.authorizedCodeKey="code",this.router=_(Fe),this.alertService=_(Ue),this.storage=_(_e),this.ticketConfig=_(hr),this.authApi=_(Er),this.tokenManagementService=_(Tr),this.toastService=_($e),this.loaderService=_(Me)}generateCodeVerifier(c=128){let l=this.generateCharacterList("A","Z")+this.generateCharacterList("a","z")+this.generateCharacterList("0","9")+"-._~",y="",S=new Uint32Array(c);crypto.getRandomValues(S);for(let R=0;R<c;R++)y+=l.charAt(S[R]%l.length);return y}generateCodeChallenge(c){return w(this,null,function*(){let y=new TextEncoder().encode(c),S=yield crypto.subtle.digest("SHA-256",y),R=Array.from(new Uint8Array(S));return btoa(R.map(P=>String.fromCharCode(P)).join("")).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")})}generateRedirectUri(){return window.location.origin+"/auth/handler"}authWithRedirect(){return w(this,arguments,function*({returnPath:c,registration:l}={}){let y=yield V(this.authApi.fetchProviderClientId(this.ticketConfig.authProviderId)),S=this.generateCodeVerifier();yield this.storage.set(this.codeVerifierKey,S),c?yield this.storage.set(this.returnPathKey,c):yield this.storage.set(this.returnPathKey,window.location.pathname+window.location.search);let R=yield this.generateCodeChallenge(S),C=this.generateRedirectUri(),P=new URLSearchParams(At({response_type:"code",client_id:y.clientId,redirect_uri:C,code_challenge:R,code_challenge_method:"S256",scope:y.scopes},l?{on_no_session:"sign_up"}:{})),N=`${y.endpointBase}/oauth/authorize?${P.toString()}`;window.location.href=N})}handleRedirect(){return w(this,null,function*(){let c=window.location,y=new URLSearchParams(c.search).get(this.authorizedCodeKey),S=yield this.storage.get(this.codeVerifierKey),R=(yield this.storage.get(this.returnPathKey))??"/";if(this.deleteOAuthState(),!y||!S){this.alertService.showSimpleErrorAlert({message:"\u8A8D\u8A3C\u60C5\u5831\u304C\u78BA\u8A8D\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u518D\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}),this.router.navigate(["/"],{replaceUrl:!0});return}let C=yield V(this.authApi.fetchProviderClientId(this.ticketConfig.authProviderId)),P=yield V(this.authApi.fetchToken(C,S,y,this.generateRedirectUri())).catch(()=>null);if(!P){this.alertService.showSimpleErrorAlert({message:"\u8A8D\u8A3C\u72B6\u614B\u304C\u78BA\u8A8D\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u518D\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}),this.router.navigate(["/"],{replaceUrl:!0});return}let N=yield V(this.authApi.createSession(this.ticketConfig.authProviderId,P.idToken)).catch(()=>null);if(!N){this.alertService.showSimpleErrorAlert({message:"\u8A8D\u8A3C\u72B6\u614B\u304C\u78BA\u8A8D\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002\u518D\u5EA6\u304A\u8A66\u3057\u304F\u3060\u3055\u3044"}),this.router.navigate(["/"],{replaceUrl:!0});return}yield this.tokenManagementService.setApiAccessToken(N.id,N.expiresAt),this.toastService.open({message:"\u30ED\u30B0\u30A4\u30F3\u3057\u307E\u3057\u305F",duration:3e3});let W=new URL(R,window.location.origin),v=W.pathname,b={};W.searchParams.forEach((O,B)=>{b[B]=O}),this.router.navigate([v],{queryParams:b,replaceUrl:!0})})}signOut(c){return w(this,null,function*(){if(this.loaderService.showLoader({message:"\u30ED\u30B0\u30A2\u30A6\u30C8\u3057\u3066\u3044\u307E\u3059..."}),this.ticketConfig.authProviderId==="adapter"&&!this.ticketConfig.authSingleSignOut){window.location.href=c;return}let l=yield V(this.authApi.fetchProviderClientId(this.ticketConfig.authProviderId)).catch(()=>null);if(!l){window.location.href=c;return}let y=l.endpointBase+`/sessions/logout?returnTo=${encodeURIComponent(`${window.location.origin}${c}`)}&client_id=${l.clientId}`;window.location.href=y})}deleteOAuthState(){return w(this,null,function*(){yield Promise.all([this.storage.remove(this.codeVerifierKey),this.storage.remove(this.returnPathKey)])})}generateCharacterList(c,l){let y=l.charCodeAt(0)-c.charCodeAt(0)+1;return new Array(y).fill(0).map((S,R)=>String.fromCharCode(c.charAt(0).charCodeAt(0)+R)).join("")}};i.\u0275fac=function(l){return new(l||i)},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let u=i;return u})();var Rr=(()=>{let i=class i{constructor(){this.oauthService=_(Ar),this.userService=_(ze)}ngOnInit(){return w(this,null,function*(){yield this.oauthService.handleRedirect(),yield V(this.userService.fetchCurrentUser()).catch(()=>null)})}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=q({type:i,selectors:[["page-auth-handler"]],standalone:!0,features:[J],decls:0,vars:0,template:function(l,y){},dependencies:[Z]});let u=i;return u})();var $n=[{path:"handler",component:Rr}],Ta=$n;export{Zn as a,br as b,_e as c,ze as d,Sr as e,wr as f,Ko as g,Ke as h,ii as i,ui as j,Bi as k,Tr as l,Ar as m,$n as n,Ta as o};
//# sourceMappingURL=chunk-FOLYN2CC.js.map
